<Window x:Class="TaskManager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="å››è±¡é™ä»»åŠ¡ç®¡ç†å™¨" Height="800" Width="1400"
        WindowStartupLocation="CenterScreen">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- èœå•æ  -->
        <Menu Grid.Row="0">
            <MenuItem Header="æ–‡ä»¶(_F)">
                <MenuItem Header="æ–°å»ºä»»åŠ¡(_N)" Click="AddTask_Click"/>
                <Separator/>
                <MenuItem Header="å¯¼å‡ºä»Šæ—¥ä»»åŠ¡åˆ°Word(_W)" Click="ExportTodayToWord_Click"/>
                <MenuItem Header="å¯¼å‡ºä»Šæ—¥ä»»åŠ¡åˆ°PDF(_P)" Click="ExportTodayToPdf_Click"/>
                <Separator/>
                <MenuItem Header="é€€å‡º(_X)" Click="Exit_Click"/>
            </MenuItem>
            <MenuItem Header="è§†å›¾(_V)">
                <MenuItem Header="å››è±¡é™è§†å›¾(_Q)" Click="ShowQuadrantView_Click"/>
                <MenuItem Header="åˆ—è¡¨è§†å›¾(_L)" Click="ShowListView_Click"/>
                <MenuItem Header="æ—¥åŽ†è§†å›¾(_C)" Click="ShowCalendarView_Click"/>
                <Separator/>
                <MenuItem Header="å…¨éƒ¨ä»»åŠ¡(_A)" Click="ShowAllTasks_Click"/>
                <MenuItem Header="ä»Šæ—¥ä»»åŠ¡(_T)" Click="ShowTodayTasks_Click"/>
                <Separator/>
                <MenuItem Name="mnuTopmost" Header="ç½®é¡¶æ˜¾ç¤º(_T)" IsCheckable="True" Click="ToggleTopmost_Click"/>
                <MenuItem Name="mnuMiniWidget" Header="æ¡Œé¢å°ç»„ä»¶(_W)" IsCheckable="True" Click="ToggleMiniWidget_Click"/>
            </MenuItem>
            <MenuItem Header="å·¥å…·(_T)">
                <MenuItem Header="æ ‡ç­¾ç®¡ç†(_M)" Click="ManageTags_Click"/>
                <MenuItem Header="ä»»åŠ¡ç­›é€‰(_F)" Click="ShowTaskFilter_Click"/>
                <MenuItem Header="ç³»ç»Ÿæ—¥åŽ†é›†æˆ(_S)" Click="IntegrateSystemCalendar_Click"/>
            </MenuItem>
            <MenuItem Header="å¸®åŠ©(_H)">
                <MenuItem Header="å…³äºŽ(_A)" Click="About_Click"/>
            </MenuItem>
        </Menu>

        <!-- æ ‡é¢˜å’Œæ—¥æœŸ -->
        <Grid Grid.Row="1" Margin="10,10,10,5">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            
            <StackPanel Grid.Column="0" Orientation="Horizontal">
                <TextBlock Name="txtDateTitle" FontSize="18" FontWeight="Bold" VerticalAlignment="Center"/>
                <TextBlock Text=" - ä»Šæ—¥ä»»åŠ¡å››è±¡é™" FontSize="18" FontWeight="Bold" VerticalAlignment="Center"/>
            </StackPanel>
            
            <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="10,0">
                <Button Name="btnSwitchToList" Content="åˆ‡æ¢åˆ°åˆ—è¡¨è§†å›¾" Padding="10,5" Click="ShowListView_Click"/>
                <Button Name="btnCalendarView" Content="ðŸ“… æ—¥åŽ†è§†å›¾" Margin="10,0,0,0" Padding="10,5" Click="ShowCalendarView_Click"/>
                <Button Name="btnRefresh" Content="åˆ·æ–°" Margin="10,0,0,0" Padding="10,5" Click="RefreshTasks_Click"/>
                <Button Name="btnTopmost" Content="ðŸ“Œ ç½®é¡¶" Margin="10,0,0,0" Padding="10,5" Click="ToggleTopmost_Click"/>
                <Button Name="btnMiniWidget" Content="ðŸ”² å°ç»„ä»¶" Margin="10,0,0,0" Padding="10,5" Click="ToggleMiniWidget_Click"/>
            </StackPanel>
            
            <StackPanel Grid.Column="2" Orientation="Horizontal">
                <Button Content="å¯¼å‡ºWord" Margin="5,0" Padding="10,5" Click="ExportTodayToWord_Click"/>
                <Button Content="å¯¼å‡ºPDF" Margin="5,0" Padding="10,5" Click="ExportTodayToPdf_Click"/>
            </StackPanel>
        </Grid>

        <!-- ä¸»è¦å†…å®¹åŒºåŸŸ - å››è±¡é™è§†å›¾å’Œåˆ—è¡¨è§†å›¾ -->
        <Grid Grid.Row="2" Margin="10">
            <!-- å››è±¡é™è§†å›¾ -->
            <Grid Name="QuadrantView">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- åæ ‡è½´æ ‡ç­¾ -->
                <TextBlock Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" 
                          Text="é‡è¦æ€§ â†’" FontSize="14" FontWeight="Bold" 
                          HorizontalAlignment="Center" Margin="0,0,0,10"/>
                
                <TextBlock Grid.Row="1" Grid.Column="0" Grid.RowSpan="2"
                          Text="ç´§æ€¥æ€§ â†“" FontSize="14" FontWeight="Bold" 
                          VerticalAlignment="Center" HorizontalAlignment="Left"
                          RenderTransformOrigin="0.5,0.5" Margin="0,0,10,0">
                    <TextBlock.RenderTransform>
                        <RotateTransform Angle="-90"/>
                    </TextBlock.RenderTransform>
                </TextBlock>

                <!-- ç¬¬ä¸€è±¡é™ï¼šç´§æ€¥ä¸”é‡è¦ -->
                <Border Grid.Row="1" Grid.Column="1" BorderBrush="#D32F2F" BorderThickness="2" 
                        Background="#FFEBEE" Margin="5" CornerRadius="5">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Grid.Row="0" Text="ç¬¬ä¸€è±¡é™ï¼šç´§æ€¥ä¸”é‡è¦" 
                                  FontWeight="Bold" FontSize="14" Foreground="#D32F2F"
                                  HorizontalAlignment="Center" Margin="5"/>
                        
                        <ScrollViewer Grid.Row="1" Margin="5">
                            <ItemsControl Name="lstQuadrant1">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="White" BorderBrush="#D32F2F" BorderThickness="1" 
                                               Margin="2" Padding="8" CornerRadius="3" Cursor="Hand"
                                               MouseLeftButtonDown="TaskItem_Click">
                                            <StackPanel>
                                                <TextBlock Text="{Binding Title}" FontWeight="Bold" TextWrapping="Wrap"/>
                                                <TextBlock Text="{Binding Description}" FontSize="11" 
                                                          Foreground="Gray" TextWrapping="Wrap" Margin="0,2,0,0"/>
                                                <TextBlock Text="{Binding TagsDisplay}" FontSize="9" 
                                                          Foreground="#2196F3" TextWrapping="Wrap" Margin="0,2,0,0"/>
                                                <StackPanel Orientation="Horizontal" Margin="0,3,0,0">
                                                    <TextBlock Text="{Binding Status}" FontSize="10" 
                                                              Background="#E3F2FD" Padding="3,1" Margin="0,0,5,0"/>
                                                    <TextBlock Text="{Binding DueDate, StringFormat=MM-dd}" 
                                                              FontSize="10" Foreground="#666"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                        
                        <Button Grid.Row="2" Content="+ æ·»åŠ ä»»åŠ¡" Margin="5" Padding="5"
                               Click="AddTaskToQuadrant1_Click" Background="#FFCDD2"/>
                    </Grid>
                </Border>

                <!-- ç¬¬äºŒè±¡é™ï¼šç´§æ€¥ä½†ä¸é‡è¦ -->
                <Border Grid.Row="1" Grid.Column="0" BorderBrush="#FF9800" BorderThickness="2" 
                        Background="#FFF3E0" Margin="5" CornerRadius="5">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Grid.Row="0" Text="ç¬¬äºŒè±¡é™ï¼šç´§æ€¥ä½†ä¸é‡è¦" 
                                  FontWeight="Bold" FontSize="14" Foreground="#FF9800"
                                  HorizontalAlignment="Center" Margin="5"/>
                        
                        <ScrollViewer Grid.Row="1" Margin="5">
                            <ItemsControl Name="lstQuadrant2">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="White" BorderBrush="#FF9800" BorderThickness="1" 
                                               Margin="2" Padding="8" CornerRadius="3" Cursor="Hand"
                                               MouseLeftButtonDown="TaskItem_Click">
                                            <StackPanel>
                                                <TextBlock Text="{Binding Title}" FontWeight="Bold" TextWrapping="Wrap"/>
                                                <TextBlock Text="{Binding Description}" FontSize="11" 
                                                          Foreground="Gray" TextWrapping="Wrap" Margin="0,2,0,0"/>
                                                <TextBlock Text="{Binding TagsDisplay}" FontSize="9" 
                                                          Foreground="#FF9800" TextWrapping="Wrap" Margin="0,2,0,0"/>
                                                <StackPanel Orientation="Horizontal" Margin="0,3,0,0">
                                                    <TextBlock Text="{Binding Status}" FontSize="10" 
                                                              Background="#E3F2FD" Padding="3,1" Margin="0,0,5,0"/>
                                                    <TextBlock Text="{Binding DueDate, StringFormat=MM-dd}" 
                                                              FontSize="10" Foreground="#666"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                        
                        <Button Grid.Row="2" Content="+ æ·»åŠ ä»»åŠ¡" Margin="5" Padding="5"
                               Click="AddTaskToQuadrant2_Click" Background="#FFE0B2"/>
                    </Grid>
                </Border>

                <!-- ç¬¬ä¸‰è±¡é™ï¼šé‡è¦ä½†ä¸ç´§æ€¥ -->
                <Border Grid.Row="2" Grid.Column="1" BorderBrush="#2196F3" BorderThickness="2" 
                        Background="#E3F2FD" Margin="5" CornerRadius="5">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Grid.Row="0" Text="ç¬¬ä¸‰è±¡é™ï¼šé‡è¦ä½†ä¸ç´§æ€¥" 
                                  FontWeight="Bold" FontSize="14" Foreground="#2196F3"
                                  HorizontalAlignment="Center" Margin="5"/>
                        
                        <ScrollViewer Grid.Row="1" Margin="5">
                            <ItemsControl Name="lstQuadrant3">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="White" BorderBrush="#2196F3" BorderThickness="1" 
                                               Margin="2" Padding="8" CornerRadius="3" Cursor="Hand"
                                               MouseLeftButtonDown="TaskItem_Click">
                                            <StackPanel>
                                                <TextBlock Text="{Binding Title}" FontWeight="Bold" TextWrapping="Wrap"/>
                                                <TextBlock Text="{Binding Description}" FontSize="11" 
                                                          Foreground="Gray" TextWrapping="Wrap" Margin="0,2,0,0"/>
                                                <TextBlock Text="{Binding TagsDisplay}" FontSize="9" 
                                                          Foreground="#2196F3" TextWrapping="Wrap" Margin="0,2,0,0"/>
                                                <StackPanel Orientation="Horizontal" Margin="0,3,0,0">
                                                    <TextBlock Text="{Binding Status}" FontSize="10" 
                                                              Background="#E3F2FD" Padding="3,1" Margin="0,0,5,0"/>
                                                    <TextBlock Text="{Binding DueDate, StringFormat=MM-dd}" 
                                                              FontSize="10" Foreground="#666"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                        
                        <Button Grid.Row="2" Content="+ æ·»åŠ ä»»åŠ¡" Margin="5" Padding="5"
                               Click="AddTaskToQuadrant3_Click" Background="#BBDEFB"/>
                    </Grid>
                </Border>

                <!-- ç¬¬å››è±¡é™ï¼šæ—¢ä¸ç´§æ€¥ä¹Ÿä¸é‡è¦ -->
                <Border Grid.Row="2" Grid.Column="0" BorderBrush="#9E9E9E" BorderThickness="2" 
                        Background="#F5F5F5" Margin="5" CornerRadius="5">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Grid.Row="0" Text="ç¬¬å››è±¡é™ï¼šæ—¢ä¸ç´§æ€¥ä¹Ÿä¸é‡è¦" 
                                  FontWeight="Bold" FontSize="14" Foreground="#9E9E9E"
                                  HorizontalAlignment="Center" Margin="5"/>
                        
                        <ScrollViewer Grid.Row="1" Margin="5">
                            <ItemsControl Name="lstQuadrant4">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="White" BorderBrush="#9E9E9E" BorderThickness="1" 
                                               Margin="2" Padding="8" CornerRadius="3" Cursor="Hand"
                                               MouseLeftButtonDown="TaskItem_Click">
                                            <StackPanel>
                                                <TextBlock Text="{Binding Title}" FontWeight="Bold" TextWrapping="Wrap"/>
                                                <TextBlock Text="{Binding Description}" FontSize="11" 
                                                          Foreground="Gray" TextWrapping="Wrap" Margin="0,2,0,0"/>
                                                <TextBlock Text="{Binding TagsDisplay}" FontSize="9" 
                                                          Foreground="#9E9E9E" TextWrapping="Wrap" Margin="0,2,0,0"/>
                                                <StackPanel Orientation="Horizontal" Margin="0,3,0,0">
                                                    <TextBlock Text="{Binding Status}" FontSize="10" 
                                                              Background="#E3F2FD" Padding="3,1" Margin="0,0,5,0"/>
                                                    <TextBlock Text="{Binding DueDate, StringFormat=MM-dd}" 
                                                              FontSize="10" Foreground="#666"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                        
                        <Button Grid.Row="2" Content="+ æ·»åŠ ä»»åŠ¡" Margin="5" Padding="5"
                               Click="AddTaskToQuadrant4_Click" Background="#EEEEEE"/>
                    </Grid>
                </Border>
            </Grid>

            <!-- åˆ—è¡¨è§†å›¾ -->
            <Grid Name="ListView" Visibility="Collapsed">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="300"/>
                </Grid.ColumnDefinitions>

                <!-- å·¦ä¾§ï¼šå¯¼èˆªå’Œæœç´¢ -->
                <GroupBox Grid.Column="0" Header="å¯¼èˆª" Margin="0,0,10,0">
                    <StackPanel>
                        <Button Name="btnAllTasks" Content="å…¨éƒ¨ä»»åŠ¡" Margin="5" Padding="10,5" Click="ShowAllTasks_Click"/>
                        <Button Name="btnQuadrant1" Content="ç´§æ€¥ä¸”é‡è¦" Margin="5" Padding="10,5" Click="ShowQuadrant1_Click" Background="#FFCDD2"/>
                        <Button Name="btnQuadrant2" Content="ç´§æ€¥ä½†ä¸é‡è¦" Margin="5" Padding="10,5" Click="ShowQuadrant2_Click" Background="#FFE0B2"/>
                        <Button Name="btnQuadrant3" Content="é‡è¦ä½†ä¸ç´§æ€¥" Margin="5" Padding="10,5" Click="ShowQuadrant3_Click" Background="#BBDEFB"/>
                        <Button Name="btnQuadrant4" Content="æ—¢ä¸ç´§æ€¥ä¹Ÿä¸é‡è¦" Margin="5" Padding="10,5" Click="ShowQuadrant4_Click" Background="#EEEEEE"/>
                        <Separator Margin="5"/>
                        <Button Name="btnTodayTasks" Content="ä»Šæ—¥ä»»åŠ¡" Margin="5" Padding="10,5" Click="ShowTodayTasks_Click" Background="#C8E6C9"/>
                        
                        <!-- æœç´¢æ¡† -->
                        <TextBox Name="txtSearch" Margin="5" Padding="5" Text="æœç´¢ä»»åŠ¡..." Foreground="Gray" 
                                 GotFocus="SearchBox_GotFocus" LostFocus="SearchBox_LostFocus" TextChanged="SearchBox_TextChanged"/>
                    </StackPanel>
                </GroupBox>

                <!-- ä¸­é—´ï¼šä»»åŠ¡åˆ—è¡¨ -->
                <GroupBox Grid.Column="1" Header="ä»»åŠ¡åˆ—è¡¨" Margin="0,0,10,0">
                    <DataGrid Name="dgTasks" AutoGenerateColumns="False" CanUserAddRows="False" 
                              SelectionMode="Single" GridLinesVisibility="Horizontal"
                              MouseDoubleClick="TaskList_MouseDoubleClick">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="çŠ¶æ€" Binding="{Binding Status}" Width="60"/>
                            <DataGridTextColumn Header="æ ‡é¢˜" Binding="{Binding Title}" Width="*"/>
                            <DataGridTextColumn Header="è±¡é™" Binding="{Binding Quadrant}" Width="120"/>
                            <DataGridTextColumn Header="æˆªæ­¢æ—¥æœŸ" Binding="{Binding DueDate, StringFormat=yyyy-MM-dd}" Width="100"/>
                            <DataGridTextColumn Header="ä¼˜å…ˆçº§" Binding="{Binding Priority}" Width="60"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </GroupBox>

                <!-- å³ä¾§ï¼šä»»åŠ¡è¯¦æƒ…å’Œæ“ä½œ -->
                <GroupBox Grid.Column="2" Header="ä»»åŠ¡è¯¦æƒ…">
                    <ScrollViewer>
                        <StackPanel>
                            <Label Content="æ ‡é¢˜:"/>
                            <TextBox Name="txtTitle" Margin="5,0,5,10"/>
                            
                            <Label Content="æè¿°:"/>
                            <TextBox Name="txtDescription" Margin="5,0,5,10" Height="80" TextWrapping="Wrap" AcceptsReturn="True"/>
                            
                            <Label Content="è±¡é™:"/>
                            <ComboBox Name="cmbQuadrant" Margin="5,0,5,10"/>
                            
                            <Label Content="æˆªæ­¢æ—¥æœŸ:"/>
                            <DatePicker Name="dpDueDate" Margin="5,0,5,10"/>
                            
                            <Label Content="çŠ¶æ€:"/>
                            <ComboBox Name="cmbStatus" Margin="5,0,5,10"/>
                            
                            <Label Content="ä¼˜å…ˆçº§:"/>
                            <ComboBox Name="cmbPriority" Margin="5,0,5,20"/>
                            
                            <!-- æ“ä½œæŒ‰é’® -->
                            <Button Name="btnAddTask" Content="æ·»åŠ ä»»åŠ¡" Margin="5" Padding="10,5" Click="AddTask_Click"/>
                            <Button Name="btnUpdateTask" Content="æ›´æ–°ä»»åŠ¡" Margin="5" Padding="10,5" Click="UpdateTask_Click" IsEnabled="False"/>
                            <Button Name="btnDeleteTask" Content="åˆ é™¤ä»»åŠ¡" Margin="5" Padding="10,5" Click="DeleteTask_Click" IsEnabled="False"/>
                            <Button Name="btnClearForm" Content="æ¸…ç©ºè¡¨å•" Margin="5" Padding="10,5" Click="ClearForm_Click"/>
                        </StackPanel>
                    </ScrollViewer>
                </GroupBox>
            </Grid>
        </Grid>

        <!-- åº•éƒ¨çŠ¶æ€æ  -->
        <StatusBar Grid.Row="3">
            <StatusBarItem>
                <TextBlock Name="txtStatus" Text="å°±ç»ª"/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Name="txtTaskCount" Margin="10,0" VerticalAlignment="Center"/>
                    <TextBlock Name="txtTopmostStatus" Margin="10,0" VerticalAlignment="Center" Foreground="Blue"/>
                    <Button Name="btnQuickAdd" Content="å¿«é€Ÿæ·»åŠ ä»»åŠ¡" Margin="5,0" Padding="10,2" Click="QuickAddTask_Click"/>
                </StackPanel>
            </StatusBarItem>
        </StatusBar>

        <!-- å¿«é€Ÿæ·»åŠ ä»»åŠ¡å¼¹çª— -->
        <Grid Name="QuickAddPanel" Grid.Row="0" Grid.RowSpan="4" Background="#80000000" Visibility="Collapsed">
            <Border Background="White" Width="500" Height="450" CornerRadius="10" 
                   HorizontalAlignment="Center" VerticalAlignment="Center">
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="å¿«é€Ÿæ·»åŠ ä»»åŠ¡" FontSize="16" FontWeight="Bold" 
                              HorizontalAlignment="Center" Margin="0,0,0,15"/>
                    
                    <ScrollViewer Grid.Row="1">
                        <StackPanel>
                            <Label Content="ä»»åŠ¡æ ‡é¢˜:"/>
                            <TextBox Name="txtQuickTitle" Margin="0,0,0,10"/>
                            
                            <Label Content="ä»»åŠ¡æè¿°:"/>
                            <TextBox Name="txtQuickDescription" Height="60" TextWrapping="Wrap" AcceptsReturn="True" Margin="0,0,0,10"/>
                            
                            <Label Content="é€‰æ‹©è±¡é™:"/>
                            <ComboBox Name="cmbQuickQuadrant" Margin="0,0,0,10"/>
                            
                            <Label Content="ä»»åŠ¡åˆ†ç±»:"/>
                            <ComboBox Name="cmbQuickCategory" Margin="0,0,0,10"/>
                            
                            <Label Content="æˆªæ­¢æ—¥æœŸ:"/>
                            <DatePicker Name="dpQuickDueDate" Margin="0,0,0,10"/>
                            
                            <Label Content="å¯é€‰æ ‡ç­¾:" FontWeight="Bold"/>
                            <Border BorderBrush="LightGray" BorderThickness="1" Padding="8" 
                                   Margin="0,5,0,15" MinHeight="60" Background="White">
                                <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="100">
                                    <WrapPanel Name="pnlQuickTags"/>
                                </ScrollViewer>
                            </Border>
                            
                            <Label Content="å·²é€‰æ ‡ç­¾:" FontWeight="Bold"/>
                            <Border BorderBrush="LightGray" BorderThickness="1" Padding="8" 
                                   Margin="0,5,0,15" MinHeight="35" Background="#F8F8F8">
                                <WrapPanel Name="pnlQuickSelectedTags"/>
                            </Border>
                            
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <Button Name="btnQuickCreateTag" Content="âž• åˆ›å»ºæ ‡ç­¾" Padding="12,6" 
                                       Margin="0,0,15,0" Click="QuickCreateTag_Click" Background="#4CAF50" 
                                       Foreground="White" BorderThickness="0"/>
                                <Button Name="btnQuickClearTags" Content="ðŸ—‘ï¸ æ¸…ç©ºæ ‡ç­¾" Padding="12,6" 
                                       Click="QuickClearTags_Click" Background="#FF5722" 
                                       Foreground="White" BorderThickness="0"/>
                            </StackPanel>
                            
                            <TextBlock Text="ðŸ’¡ ç‚¹å‡»å¯é€‰æ ‡ç­¾æ·»åŠ åˆ°ä»»åŠ¡ï¼Œç‚¹å‡»å·²é€‰æ ‡ç­¾çš„ Ã— ç§»é™¤" 
                                      FontSize="11" Foreground="Gray" TextAlignment="Center" 
                                      Margin="0,10,0,0" TextWrapping="Wrap"/>
                        </StackPanel>
                    </ScrollViewer>
                    
                    <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,15,0,0">
                        <Button Content="æ·»åŠ " Padding="15,5" Margin="0,0,10,0" Click="ConfirmQuickAdd_Click"/>
                        <Button Content="å–æ¶ˆ" Padding="15,5" Click="CancelQuickAdd_Click"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Window>